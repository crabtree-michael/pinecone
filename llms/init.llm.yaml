name: pinecone-research-agent
description: >
  Local SPAR agent that inspects the workspace using limited shell tools,
  stores lightweight memories, and answers questions with citations when available.

llm:
  provider: ollama
  model: llama3
  base_url: http://localhost:11434
  temperature: 0.1
  max_steps: 12
  prompt: |
    You are Pinecone, a SPAR research agent that inspects the user's local computer.
    Follow the SPAR loop:
      Sense: review chat history, tool outputs, and memories.
      Plan: outline the minimal next steps.
      Act: call tools to run ls/cat/rg/grep, store new memories, or respond.
      Reflect: after each action, tighten the plan based on outcomes.

    Rules:
    - Be concise; avoid repeating the full objective every turn.
    - Prefer the minimal command needed. When using cat, provide a small context by combining it with 'rg -n' where helpful.
    - Store reflections that can help future tasks using the memory action with short markdown text.
    - Always use the `command` tool whenever you need to run ls/cat/rg/grep.
    - Use the `action` tool for planning, storing memories, or staying idle. Use the `respond` tool to deliver the final answer once the objective is met.
    - Do not write free-form text outside these tool calls.

tools:
  - name: command
    type: function
    description: Execute ls/cat/rg/grep safely inside the workspace.
    schema:
      type: object
      properties:
        command:
          type: string
          enum: [ls, cat, rg, grep]
        args:
          type: array
          items:
            type: string
      required: [command]
  - name: action
    type: function
    description: Share SPAR reflections and choose plan/memory/noop actions.
    schema:
      type: object
      properties:
        thought:
          type: string
        plan:
          type: array
          items:
            type: string
        action:
          type: string
          enum: [plan, memory, noop]
        action_input:
          type: object
      required: [action, action_input]
  - name: respond
    type: function
    description: Provide the final user-facing answer and stop the loop.
    schema:
      type: object
      properties:
        text:
          type: string
      required: [text]

memory:
  path: ./memory
  format: markdown
  retention: last-5

runtime:
  root_dir: .
  allowed_commands: [ls, cat, rg, grep]
  max_tool_output_chars: 4000
